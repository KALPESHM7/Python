{% extends "base.html" %}
{% block content %}
<h2>Published Posts {% if tag_filter %}— Tag: “{{ tag_filter }}”{% endif %}</h2>

{% for p in posts %}
  <article class="content-section">
    <div class="article-metadata">
      {% if p.is_featured %}<span class="tag featured">Featured</span>{% endif %}
      <small class="text-muted">Published: {{ p.published_at.strftime('%Y-%m-%d') }}</small>
    </div>
    <h3><a class="article-title" href="{{ url_for('posts.detail_post', slug=p.slug) }}">{{ p.note.title }}</a></h3>
    <p class="article-content">{{ p.note.body[:240] }}{% if p.note.body|length > 240 %}...{% endif %}</p>
    {% if p.tags %}
      <p>
        {% for t in p.tags %}
          <a class="tag" href="{{ url_for('tags.posts_by_tag', name=t.name) }}">{{ t.name }}</a>
        {% endfor %}
      </p>
    {% endif %}
    <a href="{{ url_for('posts.detail_post', slug=p.slug) }}" class="btn-custom">Read</a>
  </article>
{% else %}
  <p>No posts yet.</p>
{% endfor %}
{% endblock %}
